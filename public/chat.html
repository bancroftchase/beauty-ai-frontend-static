<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=no" name="viewport"/>
<title>Beauty Chat - Luminous AI</title>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/>
<meta content="#B8860B" name="theme-color"/>
<style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-charcoal: #2C2C2C;
            --luminous-gold: #B8860B;
            --pearl-white: #F8F8F8;
            --premium-gradient: linear-gradient(135deg, #B8860B, #DAA520);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-charcoal);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 414px;
            margin: 0 auto;
            background: var(--primary-charcoal);
            min-height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: var(--primary-charcoal);
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #3A3A3A;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .back-btn {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--premium-gradient);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .cart-btn {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--premium-gradient);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            position: relative;
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4444;
            color: white;
            border-radius: 10px;
            padding: 2px 6px;
            font-size: 10px;
            font-weight: bold;
            min-width: 16px;
            text-align: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: white;
            background: var(--premium-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .chat-area {
            flex: 1;
            padding: 20px;
            background: var(--pearl-white);
            color: #333;
            overflow-y: auto;
            max-height: calc(100vh - 200px);
        }

        .welcome-message {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .quick-action-btn {
            background: var(--premium-gradient);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .quick-action-btn:hover {
            transform: translateY(-2px);
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-content {
            background: white;
            padding: 12px 16px;
            border-radius: 16px;
            max-width: 80%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .message.user .message-content {
            background: var(--premium-gradient);
            color: white;
        }

        .products-header {
            background: var(--premium-gradient);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin: 20px 0 15px 0;
            text-align: center;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }

        .product-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }

        .product-image {
            width: 100%;
            height: 80px;
            margin-bottom: 10px;
            border-radius: 8px;
            overflow: hidden;
            background: var(--premium-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 20px;
        }

        .product-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--luminous-gold);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 8px;
            font-weight: bold;
        }

        .product-name {
            font-weight: 700;
            font-size: 12px;
            color: var(--primary-charcoal);
            margin-bottom: 4px;
            line-height: 1.2;
        }

        .product-brand {
            font-size: 10px;
            color: #666;
            margin-bottom: 4px;
        }

        .product-price {
            font-size: 14px;
            color: var(--luminous-gold);
            font-weight: 700;
            margin-bottom: 4px;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 6px;
        }

        .stars {
            color: #ffd700;
            font-size: 10px;
        }

        .review-count {
            font-size: 9px;
            color: #666;
        }

        .product-country {
            font-size: 9px;
            color: var(--luminous-gold);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .add-to-cart-btn {
            background: var(--premium-gradient);
            color: white;
            border: none;
            padding: 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
        }

        .add-to-cart-btn:hover {
            transform: scale(1.05);
        }

        .input-area {
            background: var(--primary-charcoal);
            padding: 20px;
            border-top: 1px solid #3A3A3A;
            position: sticky;
            bottom: 0;
        }

        .input-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .refresh-btn {
            background: var(--premium-gradient);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .input-container {
            display: flex;
            align-items: center;
            gap: 12px;
            background: white;
            border-radius: 25px;
            padding: 12px 20px;
        }

        .message-input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 14px;
            background: transparent;
        }

        .send-btn {
            background: var(--premium-gradient);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
        }

        .status-message {
            background: #e8f5e8;
            color: #2e7d32;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 12px;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="container">
<div class="header">
<a class="back-btn" href="index.html">‚Üê Back</a>
<div class="logo">‚ú® Beauty Chat</div>
<button class="cart-btn" onclick="toggleCart()">
    üõí
    <span class="cart-count" id="cartCount">0</span>
</button>
</div>

<div class="chat-area" id="chatArea">
<div class="welcome-message">
<h3 style="color: var(--primary-charcoal); margin-bottom: 10px;">Hi! I'm your Beauty AI assistant ‚ú®</h3>
<div class="status-message">‚úÖ Frontend-only mode - Instant beauty product search!</div>
<div class="quick-actions">
<button class="quick-action-btn" onclick="sendQuickMessage('üåç Global Beauty')">üåç Global Beauty</button>
<button class="quick-action-btn" onclick="sendQuickMessage('üì∏ Instagram Trends')">üì∏ Instagram Trends</button>
<button class="quick-action-btn" onclick="sendQuickMessage('üå∏ K-Beauty')">üå∏ K-Beauty</button>
<button class="quick-action-btn" onclick="sendQuickMessage('üõí Amazon Finds')">üõí Amazon Finds</button>
<button class="quick-action-btn" onclick="sendQuickMessage('üåø Natural Beauty')">üåø Natural Beauty</button>
<button class="quick-action-btn" onclick="sendQuickMessage('üíé Luxury Skincare')">üíé Luxury Skincare</button>
</div>
</div>
</div>

<div class="input-area">
<div class="input-controls">
<button class="refresh-btn" onclick="refreshChat()">üîÑ New Search</button>
</div>
<div class="input-container">
<input class="message-input" id="messageInput" onkeypress="handleKeyPress(event)" placeholder="Ask about beauty products..." type="text"/>
<button class="send-btn" onclick="sendMessage()">‚ñ∂</button>
</div>
</div>
</div>

<script>
        // üåü FRONTEND-ONLY BEAUTY PRODUCT DATABASE
        const BEAUTY_DATABASE = {
            // Global Beauty Products from 50+ Countries
            global: [
                { id: 'g1', name: 'Luxury Rose Serum', brand: 'Chanel', price: '$280.00', country: 'France', category: 'Serum', description: 'Premium French luxury skincare with rare rose extracts from Grasse.' },
                { id: 'g2', name: 'Snail Mucin Essence', brand: 'COSRX', price: '$25.00', country: 'South Korea', category: 'Essence', description: 'Korean beauty innovation with 96% snail secretion filtrate.' },
                { id: 'g3', name: 'A√ßa√≠ Anti-Aging Cream', brand: 'Natura', price: '$45.00', country: 'Brazil', category: 'Moisturizer', description: 'Brazilian botanical skincare with Amazon a√ßa√≠ and natural oils.' },
                { id: 'g4', name: 'Scientific Retinol Complex', brand: 'Dr. Barbara Sturm', price: '$215.00', country: 'Germany', category: 'Treatment', description: 'German precision skincare with advanced retinol technology.' },
                { id: 'g5', name: 'Sake Brightening Mask', brand: 'Tatcha', price: '$68.00', country: 'Japan', category: 'Mask', description: 'Japanese innovation with fermented sake and rice for radiant skin.' },
                { id: 'g6', name: 'Vitamin C Serum', brand: 'SkinCeuticals', price: '$166.00', country: 'USA', category: 'Serum', description: 'American dermatology-grade vitamin C for protection and brightness.' },
                { id: 'g7', name: 'Argan Oil Elixir', brand: 'Argania', price: '$32.00', country: 'Morocco', category: 'Oil', description: 'Pure Moroccan argan oil for face and hair nourishment.' },
                { id: 'g8', name: 'Alpine Herb Cleanser', brand: 'Weleda', price: '$12.00', country: 'Switzerland', category: 'Cleanser', description: 'Swiss natural skincare with organic alpine botanicals.' },
                { id: 'g9', name: 'Dead Sea Mud Mask', brand: 'AHAVA', price: '$38.00', country: 'Israel', category: 'Mask', description: 'Israeli mineral-rich Dead Sea mud for deep purification.' },
                { id: 'g10', name: 'Kangaroo Paw Moisturizer', brand: 'Aesop', price: '$75.00', country: 'Australia', category: 'Moisturizer', description: 'Australian botanical skincare with native plant extracts.' }
            ],
            
            // K-Beauty Specialties
            kbeauty: [
                { id: 'k1', name: 'Glass Skin Serum', brand: 'Beauty of Joseon', price: '$17.00', country: 'South Korea', category: 'Serum', description: 'Traditional Korean hanbang ingredients for glass skin effect.' },
                { id: 'k2', name: 'Centella Calming Gel', brand: 'Purito', price: '$13.00', country: 'South Korea', category: 'Gel', description: 'Soothing centella asiatica for sensitive skin relief.' },
                { id: 'k3', name: 'Ginseng Renewal Essence', brand: 'The History of Whoo', price: '$150.00', country: 'South Korea', category: 'Essence', description: 'Luxury Korean skincare with precious ginseng extracts.' },
                { id: 'k4', name: 'Snail 92 All In One Cream', brand: 'COSRX', price: '$22.00', country: 'South Korea', category: 'Cream', description: 'Multi-purpose cream with 92% snail mucin for repair and hydration.' },
                { id: 'k5', name: 'Rice Water Bright Cleansing Foam', brand: 'The Face Shop', price: '$8.00', country: 'South Korea', category: 'Cleanser', description: 'Gentle rice water cleanser for brightening and deep cleansing.' }
            ],
            
            // Natural & Organic
            natural: [
                { id: 'n1', name: 'Organic Jojoba Oil', brand: 'Cliganic', price: '$15.99', country: 'USA', category: 'Oil', description: 'Pure organic jojoba oil for natural moisturizing and healing.' },
                { id: 'n2', name: 'Himalayan Rose Facial Mist', brand: 'Forest Essentials', price: '$28.00', country: 'India', category: 'Mist', description: 'Ayurvedic rose water mist with Himalayan spring water.' },
                { id: 'n3', name: 'Green Tea Cleansing Oil', brand: 'Innisfree', price: '$25.00', country: 'South Korea', category: 'Oil Cleanser', description: 'Natural Jeju green tea oil for gentle makeup removal.' },
                { id: 'n4', name: 'Manuka Honey Face Mask', brand: 'Farmacy', price: '$56.00', country: 'USA', category: 'Mask', description: 'Clean beauty mask with New Zealand manuka honey.' },
                { id: 'n5', name: 'Botanical Facial Oil', brand: 'Herbivore', price: '$72.00', country: 'USA', category: 'Oil', description: 'Natural facial oil blend with organic botanicals and essential oils.' }
            ],
            
            // Anti-aging
            antiaging: [
                { id: 'a1', name: 'Retinol Treatment', brand: 'Paula\'s Choice', price: '$55.00', country: 'USA', category: 'Treatment', description: 'Clinical-strength retinol for fine lines and wrinkles.' },
                { id: 'a2', name: 'Peptide Renewal Serum', brand: 'The Ordinary', price: '$28.90', country: 'Canada', category: 'Serum', description: 'Advanced peptide complex for skin firmness and elasticity.' },
                { id: 'a3', name: 'Collagen Boosting Cream', brand: 'Olay', price: '$24.99', country: 'USA', category: 'Moisturizer', description: 'Anti-aging moisturizer with collagen peptides and niacinamide.' },
                { id: 'a4', name: 'Time Revolution Serum', brand: 'Missha', price: '$49.00', country: 'South Korea', category: 'Serum', description: 'Fermented yeast extract serum for age-defying benefits.' },
                { id: 'a5', name: 'Hyaluronic Acid Intensive', brand: 'Neutrogena', price: '$15.97', country: 'USA', category: 'Serum', description: 'Concentrated hyaluronic acid for deep hydration and plumping.' }
            ],
            
            // Luxury
            luxury: [
                { id: 'l1', name: 'Platinum Rare Serum', brand: 'La Mer', price: '$500.00', country: 'USA', category: 'Serum', description: 'Ultra-luxury anti-aging serum with rare platinum extracts.' },
                { id: 'l2', name: 'Diamond Radiance Cream', brand: 'Dior', price: '$395.00', country: 'France', category: 'Moisturizer', description: 'Prestige French skincare with diamond powder and precious oils.' },
                { id: 'l3', name: 'Caviar Cellular Recovery Mask', brand: 'La Prairie', price: '$600.00', country: 'Switzerland', category: 'Mask', description: 'Swiss luxury skincare with caviar extracts and 24k gold.' },
                { id: 'l4', name: 'Royal Jelly Renewal Serum', brand: 'Sulwhasoo', price: '$230.00', country: 'South Korea', category: 'Serum', description: 'Premium Korean luxury with royal jelly and oriental herbs.' },
                { id: 'l5', name: 'Black Pearl Essence', brand: 'SK-II', price: '$185.00', country: 'Japan', category: 'Essence', description: 'Japanese luxury skincare with rare black pearl extracts.' }
            ]
        };

        let currentProducts = [];
        let displayedCount = 0;
        let shoppingCart = JSON.parse(localStorage.getItem('beautyCart')) || [];

        // Initialize cart count
        updateCartDisplay();

        function updateCartDisplay() {
            const cartCount = document.getElementById('cartCount');
            const totalItems = shoppingCart.reduce((sum, item) => sum + (item.quantity || 1), 0);
            cartCount.textContent = totalItems;
            cartCount.style.display = totalItems > 0 ? 'block' : 'none';
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        // üöÄ HYBRID SEARCH FUNCTION ‚Äì Gemini + Product Matcher
function sendMessage() {
    const messageInput = document.getElementById('messageInput');
    const message = messageInput.value.trim();

    if (!message) return;

    clearPreviousResults();
    addUserMessage(message);
    messageInput.value = '';

    // Show typing indicator
    showTyping();

    // Step 1: Ask Gemini backend
    fetch('https://beauty-ai-backend.onrender.com/ask-gemini', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt: message })
    })
    .then(res => res.json())
    .then(data => {
        hideTyping();

        const reply = data.reply || 'Hmm‚Ä¶ I didn‚Äôt get a good answer from Gemini ü§ñ';
        addBotMessage(`üí¨ Gemini AI says:\n\n${reply}`);

        // Step 2: Still run your mock product logic
        processBeautyQuery(message);
    })
    .catch(err => {
        console.error('Gemini error:', err);
        hideTyping();
        addBotMessage('‚ùå There was an error contacting Gemini AI. Try again later.');
    });
}

function processBeautyQuery(query) {
  const lowerQuery = query.toLowerCase();
  let selectedProducts = [];
  let aiResponse = '';

  const keywordMap = {
    global: ['global', 'countries', 'world', '50'],
    kbeauty: ['k-beauty', 'korean', 'korea'],
    natural: ['natural', 'organic', 'clean'],
    antiaging: ['anti-aging', 'wrinkle', 'aging', 'retinol'],
    luxury: ['luxury', 'premium', 'expensive'],
    makeup: ['lipstick', 'foundation', 'blush'],
    serum: ['serum', 'vitamin c', 'essence'],
    mask: ['mask', 'mud', 'sheet']
  };

  const categoryLabels = {
    global: 'üåç Global Beauty Products',
    kbeauty: 'üå∏ K-Beauty Favorites',
    natural: 'üåø Natural & Organic Picks',
    antiaging: 'üß¨ Anti-Aging Solutions',
    luxury: 'üíé Luxury Skincare Selections',
    makeup: 'üíÑ Popular Makeup Items',
    serum: 'üíß Targeted Serums & Essences',
    mask: 'üé≠ Hydrating & Detox Masks'
  };

  // Try to match keywords to category
  let matchedCategory = Object.keys(keywordMap).find(category =>
    keywordMap[category].some(word => lowerQuery.includes(word))
  );

  if (!matchedCategory) {
    // fallback mix
    selectedProducts = [
      ...BEAUTY_DATABASE.global.slice(0, 3),
      ...BEAUTY_DATABASE.kbeauty.slice(0, 2),
      ...BEAUTY_DATABASE.natural.slice(0, 2),
      ...BEAUTY_DATABASE.antiaging.slice(0, 2),
      ...BEAUTY_DATABASE.luxury.slice(0, 1)
    ];
    aiResponse = 'Here‚Äôs a curated beauty selection just for you!';
  } else {
    selectedProducts = BEAUTY_DATABASE[matchedCategory] || [];
    aiResponse = categoryLabels[matchedCategory] || 'Here are some products you might like:';
  }

  // Add bot message and show products
  addBotMessage(`üõçÔ∏è ${aiResponse}`);
  showProductsHeader(selectedProducts);
  currentProducts = selectedProducts;
  displayedCount = 0;
  displayProducts(selectedProducts);
}

                // Default: show a mix of all categories
                selectedProducts = [
                    ...BEAUTY_DATABASE.global.slice(0, 3),
                    ...BEAUTY_DATABASE.kbeauty.slice(0, 2),
                    ...BEAUTY_DATABASE.natural.slice(0, 2),
                    ...BEAUTY_DATABASE.antiaging.slice(0, 2),
                    ...BEAUTY_DATABASE.luxury.slice(0, 1)
                ];
                aiResponse = 'I found a curated selection of beauty products for you! This includes global favorites, K-beauty innovations, natural options, anti-aging treatments, and luxury skincare. Each product is carefully selected for its quality and effectiveness.';
            }

            // Add AI response
            addBotMessage(aiResponse);

            // Show products header
            showProductsHeader(selectedProducts);

            // Display products
            currentProducts = selectedProducts;
            displayedCount = 0;
            displayProducts(selectedProducts);
        }

        function showProductsHeader(products) {
            const chatArea = document.getElementById('chatArea');
            const headerDiv = document.createElement('div');
            headerDiv.className = 'products-header';
            
            const countries = [...new Set(products.map(p => p.country))];
            
            headerDiv.innerHTML = `
                <h3>üåç Found ${products.length} Beauty Products</h3>
                <div style="font-size: 12px; margin-top: 5px;">
                    From ${countries.length} countries: ${countries.slice(0, 5).join(', ')}${countries.length > 5 ? '...' : ''}
                </div>
            `;
            
            chatArea.appendChild(headerDiv);
        }

        function displayProducts(products) {
            const chatArea = document.getElementById('chatArea');
            const productsGrid = document.createElement('div');
            productsGrid.className = 'products-grid';

            products.forEach((product, index) => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';

                // Generate rating
                const rating = 3.5 + Math.random() * 1.5;
                const stars = '‚òÖ'.repeat(Math.floor(rating)) + '‚òÜ'.repeat(5 - Math.floor(rating));
                
                // Product badge
                let badge = '';
                if (product.country === 'South Korea') badge = 'K-BEAUTY';
                else if (parseFloat(product.price.replace('$', '')) > 100) badge = 'LUXURY';
                else if (product.category === 'Oil' || product.brand.includes('Organic')) badge = 'NATURAL';

                productCard.innerHTML = `
                    ${badge ? `<div class="product-badge">${badge}</div>` : ''}
                    <div class="product-image">‚ú®</div>
                    <div class="product-name">${product.name}</div>
                    <div class="product-brand">${product.brand}</div>
                    <div class="product-price">${product.price}</div>
                    <div class="product-rating">
                        <span class="stars">${stars}</span>
                        <span class="review-count">(${Math.floor(Math.random() * 1000) + 100})</span>
                    </div>
                    <div class="product-country">üåç ${product.country}</div>
                    <button class="add-to-cart-btn" onclick="addToCart('${product.id}')">
                        üõí Add to Cart
                    </button>
                `;

                productCard.onclick = (e) => {
                    if (!e.target.classList.contains('add-to-cart-btn')) {
                        showProductDetails(product);
                    }
                };

                productsGrid.appendChild(productCard);
            });

            chatArea.appendChild(productsGrid);
            displayedCount += products.length;
            scrollToBottom();
        }

        function addToCart(productId) {
            const product = findProductById(productId);
            if (!product) return;

            const existingItem = shoppingCart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity = (existingItem.quantity || 1) + 1;
            } else {
                shoppingCart.push({
                    ...product,
                    quantity: 1,
                    addedAt: new Date().toISOString()
                });
            }
            
            localStorage.setItem('beautyCart', JSON.stringify(shoppingCart));
            updateCartDisplay();
            
            showNotification(`Added ${product.name} to cart! üõí`);
        }

        function findProductById(id) {
            const allProducts = [
                ...BEAUTY_DATABASE.global,
                ...BEAUTY_DATABASE.kbeauty,
                ...BEAUTY_DATABASE.natural,
                ...BEAUTY_DATABASE.antiaging,
                ...BEAUTY_DATABASE.luxury
            ];
            return allProducts.find(p => p.id === id);
        }

        function showProductDetails(product) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                background: rgba(0,0,0,0.8); z-index: 10000;
                display: flex; align-items: center; justify-content: center;
                padding: 20px;
            `;

            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; padding: 30px; max-width: 90%; max-height: 80%; overflow-y: auto; position: relative;">
                    <button onclick="this.closest('[style*=position]').remove()" style="position: absolute; top: 15px; right: 20px; background: none; border: none; font-size: 28px; cursor: pointer; color: #666;">√ó</button>

                    <div style="text-align: center; margin-bottom: 25px;">
                        <h2 style="color: #2c2c2c; margin-bottom: 8px;">${product.name}</h2>
                        <p style="color: #666; margin-bottom: 8px; font-weight: 600;">${product.brand}</p>
                        <p style="color: #B8860B; font-weight: 600; margin-bottom: 16px;">üåç ${product.country}</p>
                        <div style="font-size: 28px; color: #B8860B; font-weight: 700;">${product.price}</div>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #2c2c2c; margin-bottom: 10px;">Description</h3>
                        <p style="color: #666; line-height: 1.5;">${product.description}</p>
                    </div>

                    <div style="text-align: center; display: flex; gap: 10px;">
                        <button onclick="addToCart('${product.id}'); this.closest('[style*=position]').remove();" style="background: var(--premium-gradient); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; flex: 1;">
                            üõí Add to Cart
                        </button>
                        <button onclick="this.closest('[style*=position]').remove()" style="background: #f0f0f0; color: #333; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold;">
                            Close
                        </button>
                    </div>
                </div>
            `;

            modal.onclick = (e) => {
                if (e.target === modal) modal.remove();
            };

            document.body.appendChild(modal);
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 10001;
                background: var(--premium-gradient); color: white;
                padding: 12px 20px; border-radius: 8px;
                font-size: 14px; font-weight: 600;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function clearPreviousResults() {
            const chatArea = document.getElementById('chatArea');
            const messages = chatArea.querySelectorAll('.message, .products-grid, .products-header');
            messages.forEach(message => message.remove());
        }

        function addUserMessage(message) {
            const chatArea = document.getElementById('chatArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user';
            messageDiv.innerHTML = `<div class="message-content">${message}</div>`;
            chatArea.appendChild(messageDiv);
            scrollToBottom();
        }

        function addBotMessage(message) {
            const chatArea = document.getElementById('chatArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.innerHTML = `<div class="message-content">${message}</div>`;
            chatArea.appendChild(messageDiv);
            scrollToBottom();
        }

        function sendQuickMessage(message) {
            const messageInput = document.getElementById('messageInput');
            
            const enhancedMessages = {
                'üåç Global Beauty': 'Show me beauty products from 50+ countries including French luxury, K-beauty, Brazilian botanicals, German science, Japanese innovation, and American brands',
                'üì∏ Instagram Trends': 'Show me trending makeup and viral beauty looks',
                'üå∏ K-Beauty': 'Show me Korean skincare and K-beauty products',
                'üõí Amazon Finds': 'Show me popular beauty products',
                'üåø Natural Beauty': 'Show me natural and organic beauty products',
                'üíé Luxury Skincare': 'Show me luxury and premium skincare products'
            };

            messageInput.value = enhancedMessages[message] || message;
            sendMessage();
        }

        function showTyping() {
            const chatArea = document.getElementById('chatArea');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message bot';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = '<div class="message-content" style="font-style: italic;">AI is searching beauty products... ‚ú®</div>';
            chatArea.appendChild(typingDiv);
            scrollToBottom();
        }

        function hideTyping() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function refreshChat() {
            clearPreviousResults();
            const messageInput = document.getElementById('messageInput');
            if (messageInput) {
                messageInput.value = '';
                messageInput.focus();
            }
        }

        function scrollToBottom() {
            const chatArea = document.getElementById('chatArea');
            setTimeout(() => {
                chatArea.scrollTop = chatArea.scrollHeight;
            }, 100);
        }

        function toggleCart() {
            alert(`üõí Cart: ${shoppingCart.length} items\n\nFull cart functionality coming soon!`);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚ú® Frontend-only Beauty Chat loaded!');
            
            // Auto-load global products if query parameter exists
            const urlParams = new URLSearchParams(window.location.search);
            const query = urlParams.get('query');
            
            if (query) {
                const searchInput = document.getElementById('messageInput');
                if (searchInput) {
                    searchInput.value = decodeURIComponent(query);
                    setTimeout(() => sendMessage(), 500);
                }
            }
        });
    </script>
</body>
</html>
